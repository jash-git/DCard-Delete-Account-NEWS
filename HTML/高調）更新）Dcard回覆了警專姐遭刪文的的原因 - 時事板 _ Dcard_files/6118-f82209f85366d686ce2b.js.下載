(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6118],{32631:function(e,t,r){"use strict";var n=(0,r(2784).createContext)({useModal:!1});t.Z=n},36118:function(e,t,r){"use strict";r.d(t,{Z:function(){return F}});var n=r(54530),i=r(59394),o=r(52322),a=r(85354),u=r(2784),c=r(34149),s=r(90632),l=r(95652),d=r(43248),m=r(49814),f=r(69176),h=r(39097),p=r(19126),v=r(32631),w=r(77106);function g(e){var t=e.floor,r=(0,d.Z)(),n=(0,l.Z)(r.query.postId),a=(0,u.useContext)(v.Z).useModal,c=(0,m.Z)((function(e){return(0,f.pm)(e,n)})),s=t.replace(/B/i,"");if(c&&c.commentCount<+s)return(0,o.jsx)(o.Fragment,{children:t});if(0===+s)return(0,o.jsx)("a",{children:t});var g=r.query.forumAlias||"all",x=r.route+"?"+(0,p.stringify)((0,i.Z)((0,i.Z)({},r.query),{},{commentFloor:s})),b="/f/".concat(g,"/p/").concat(n,"/b/").concat(s);return a?(0,o.jsx)(h.default,{href:x,as:b,shallow:!0,prefetch:!1,scroll:!1,children:(0,o.jsx)("a",{children:t})}):(0,o.jsx)(w.Z,{to:b,children:t})}var x=r(10252),b=r(58628),k=c.ZP.div.withConfig({componentId:"phqjxq-0"})(["white-space:pre-wrap;white-space:break-spaces;word-break:break-word;"]);function y(e){var t=e.flags;if("undefined"===typeof t){var r=e.toString().match(/[gimsuy]*$/);t=r?r[0]:""}return t.includes("g")?e:new RegExp(e,"".concat(t,"g"))}var j=[{regex:y(x.Wh),format:function(e,t){var r=(0,a.Z)(t,1)[0],n=(0,b.Z)(r);return n?(0,o.jsx)(s.Z,(0,i.Z)((0,i.Z)({},e),{},{url:n})):r}},{regex:y(x.ZM),format:function(e,t){var r=e.enableFloorlink,n=void 0===r||r,i=(0,a.Z)(t,1)[0];return n?(0,o.jsx)(g,{floor:i}):i}}];function F(e){var t=e.children,r=void 0===t?"":t,i=(0,n.Z)(e,["children"]),a=j.reduce((function(e,t){var r,n=t.regex,o=t.format;return r=function(e){return"string"!==typeof e?e:function(e,t,r){for(var n,i=[],o=0;null!=(n=e.exec(t));)i.push(t.substring(o,n.index)),i.push(r(n)),o=e.lastIndex;return i.push(t.substring(o)),i}(n,e,(function(e){return o(i,e)}))},e.reduce((function(e,t){return e.concat(r(t))}),[])}),[r.trim()]).map((function(e,t){return"string"===typeof e?(0,o.jsx)("span",{children:e},t):(0,o.jsx)(u.Fragment,{children:e},t)}));return(0,o.jsx)(k,{children:a})}},90632:function(e,t,r){"use strict";r.d(t,{Z:function(){return J}});var n=r(52322),i=r(54530),o=r(49814),a=r(55219),u=r(25237),c=r(77557),s=(0,u.default)((function(){return r.e(5593).then(r.bind(r,95593))}),{ssr:!1,loadableGenerated:{webpack:function(){return[95593]},modules:["../modules/common/components/Formatter/Linkify/thirdPartyServiceFormatter.tsx -> ../FacebookVideoPlayer"]}}),l=(0,u.default)((function(){return r.e(2708).then(r.bind(r,12708))}),{ssr:!1,loadableGenerated:{webpack:function(){return[12708]},modules:["../modules/common/components/Formatter/Linkify/thirdPartyServiceFormatter.tsx -> ../SoundCloudPlayer"]}}),d=(0,u.default)((function(){return r.e(6482).then(r.bind(r,66482))}),{loadableGenerated:{webpack:function(){return[66482]},modules:["../modules/common/components/Formatter/Linkify/thirdPartyServiceFormatter.tsx -> ../VimeoPlayer"]}}),m=(0,u.default)((function(){return r.e(8105).then(r.bind(r,68105))}),{loadableGenerated:{webpack:function(){return[68105]},modules:["../modules/common/components/Formatter/Linkify/thirdPartyServiceFormatter.tsx -> ../YoutubePlayer"]}}),f=(0,u.default)((function(){return r.e(9082).then(r.bind(r,19082))}),{loadableGenerated:{webpack:function(){return[19082]},modules:["../modules/common/components/Formatter/Linkify/thirdPartyServiceFormatter.tsx -> ../TwitchPlayer"]}}),h={format:function(e,t){switch(t.hostname){case"facebook.com":case"m.facebook.com":case"www.facebook.com":if(!e.disableFacebookVideo&&(t.pathname.includes("/videos/")||t.pathname.includes("/watch/")))return(0,n.jsx)(s,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,url:t.toString()});break;case"soundcloud.com":return(0,n.jsx)(l,{url:t.toString()});case"vimeo.com":return(0,n.jsx)(d,{id:(0,c.N)(t.pathname,1)});case"youtube.com":case"www.youtube.com":case"m.youtube.com":if(t.pathname.startsWith("/v/")||t.pathname.startsWith("/embed/"))return(0,n.jsx)(m,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,id:(0,c.N)(t.pathname,2)});if("/watch"===t.pathname){var r=t.searchParams&&t.searchParams.get("v");if(r)return(0,n.jsx)(m,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,id:r})}break;case"youtu.be":return(0,n.jsx)(m,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,id:(0,c.N)(t.pathname,1)});case"twitch.tv":case"m.twitch.tv":case"www.twitch.tv":if(t.pathname.startsWith("/videos")){var i=(0,c.N)(t.pathname,2);return(0,n.jsx)(f,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,url:t,video:i})}if(t.pathname.includes("/clip")){var o=(0,c.N)(t.pathname,3);return(0,n.jsx)(f,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,url:t,clip:o})}if(t.pathname.length>0){var a,u=t.pathname.split("/");if(2===u.length)return(0,n.jsx)(f,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,url:t,channel:null!==(a=u[1])&&void 0!==a?a:""})}break;case"clips.twitch.tv":var h=(0,c.N)(t.pathname,1);return(0,n.jsx)(f,{previewType:"video_preview",source:e.source,allowFullscreen:!e.disableFullscreen,url:t,clip:h})}}},p=r(59394),v=r(93129),w=r(9651),g=r(34149),x=g.ZP.div.withConfig({componentId:"sc-12ooe0i-0"})(["margin:",";",";"],(function(e){var t=e.mediaMargin;return t||"10px 0"}),(function(e){return e.isSticker?b:""})),b=(0,g.iv)(["width:104px;height:104px;"]),k=(0,u.default)((function(){return Promise.all([r.e(9351),r.e(6288),r.e(3295),r.e(3324)]).then(r.bind(r,50463))}),{ssr:!1,loadableGenerated:{webpack:function(){return[50463]},modules:["../modules/common/components/Formatter/Linkify/firstPartyServiceFormatter.tsx -> ../MegapxVideoPlayer"]}}),y=(0,u.default)((function(){return Promise.all([r.e(9351),r.e(6288),r.e(4024)]).then(r.bind(r,66624))}),{loadableGenerated:{webpack:function(){return[66624]},modules:["../modules/common/components/Formatter/Linkify/firstPartyServiceFormatter.tsx -> ../VividVideoPlayer"]}});function j(e){var t=e.url,r=(0,i.Z)(e,["url"]);return(0,n.jsx)(x,{children:(0,n.jsx)(k,(0,p.Z)((0,p.Z)({},r),{},{isAd:t.searchParams&&"true"===t.searchParams.get("dcard_ad")}))})}var F={format:function(e,t){var r=(0,v.g7)(t);if(r)switch(r.type){case v.Dx.Image:return(0,n.jsx)(w.Z,{maxRatio:e.mediaMaxRatio,id:r.id});case v.Dx.Video:return(0,n.jsx)(j,{id:r.id,url:t,postId:e.postId})}switch(t.hostname){case"www.dcard.tw":case"stage.dcard.io":case"www.dtto.com":case"stage.dtto.io":if(t.pathname.startsWith("/v2/vivid/videos"))return(0,n.jsx)(y,{url:t});if(t.pathname.startsWith("/webview/megapx")){var i=t.searchParams&&t.searchParams.get("id");if(i)return(0,n.jsx)(j,{id:i,url:t,postId:e.postId})}}}},Z=r(38349),P=r(49892),S=r(58628),C=r(10252);var L=new Set([".jpeg",".jpg",".gif",".png",".webp"]);var M={format:function(e,t){var r=e.mediaMargin,i=e.imageLimitHeight,o=e.mediaMaxRatio,a=function(e){var t=e.lastIndexOf(".");return t<0?"":e.substring(t).toLowerCase()}(t.pathname);if(a&&L.has(a)){var u=function(e){var t="string"===typeof e?(0,S.Z)(e):e;return!!t&&C.Mw.test(t.href)}(t),c=t.toString();return(0,n.jsx)(x,{mediaMargin:r,isSticker:u,children:(0,n.jsx)(Z.Z,{src:(0,P.S)(c,{global:!1,size:"h",resizeGif:!1}),fullSizeSrc:(0,P.S)(c,{global:!1}),limitHeight:i,maxRatio:o})})}}},H=(0,u.default)((function(){return Promise.all([r.e(9351),r.e(7866),r.e(932)]).then(r.bind(r,7866))}),{loadableGenerated:{webpack:function(){return[7866]},modules:["../modules/common/components/Formatter/Linkify/postLinkFormatter.tsx -> ../ProductPostLink"]}}),I=function(e){return{format:function(t,r){var i=r.toString().match(e)||[],o=i[1],a=i[2];if(a)return(0,n.jsx)(H,{margin:t.linkCardMargin,id:a,source:t.source,fallbackTitle:"".concat(r),fallbackForumAlias:o})}}},_=I(C.Nu),G=I(C.oO),N=(0,u.default)((function(){return r.e(6867).then(r.bind(r,26867))}),{ssr:!1,loadableGenerated:{webpack:function(){return[26867]},modules:["../modules/common/components/Formatter/Linkify/webviewFormatter.tsx -> ../DcardWebView"]}}),V=function(e){return{format:function(t,r){if(e.test(r.toString())){var i=r.searchParams&&"true"===r.searchParams.get("isWebView"),o=r.pathname.includes("makeups"),a=r.pathname.includes("groupBuy");if(i){if(o)return(0,n.jsx)(n.Fragment,{});if(a)return(0,n.jsx)(n.Fragment,{});var u=C.Nr.test(r.pathname);return(0,n.jsx)(N,{url:r,sameOrigin:u})}}}}},T=V(C.gt),W=V(C.l2),z=(0,r(77768).ZP)().isEnvProd,R=(0,u.default)((function(){return Promise.all([r.e(9351),r.e(6236),r.e(7775)]).then(r.bind(r,57775))}),{loadableGenerated:{webpack:function(){return[57775]},modules:["../modules/common/components/Formatter/Linkify/webLinkFormatter.tsx -> ../DcardWebLink"]}}),D=(0,u.default)((function(){return Promise.all([r.e(9351),r.e(6236),r.e(4448)]).then(r.bind(r,34448))}),{loadableGenerated:{webpack:function(){return[34448]},modules:["../modules/common/components/Formatter/Linkify/webLinkFormatter.tsx -> ../DttoWebLink"]}}),E=z?["dcard.tw","dcard.hk","dcard.cc","www.dcard.tw","www.dcard.hk","www.dcard.cc","mobile.dcard.tw","v2.dcard.tw"]:["stage.dcard.io","mobile-stage.dcard.io","v2.dcard.io"],q={format:function(e,t){if(E.includes(t.host))return(0,n.jsx)(R,{margin:e.linkCardMargin,url:t,source:e.source})}},A=z?["dtto.com","www.dtto.com","mobile.dtto.com"]:["stage.dtto.io","v2.dtto.io"],O={format:function(e,t){if(A.includes(t.host))return(0,n.jsx)(D,{margin:e.linkCardMargin,url:t,source:e.source})}},B=(0,u.default)((function(){return Promise.all([r.e(9351),r.e(9229)]).then(r.bind(r,29229))}),{loadableGenerated:{webpack:function(){return[29229]},modules:["../modules/common/components/Formatter/Linkify/otherLinksFormatter.tsx -> ../RichLinkCard"]}}),Y={format:function(e,t){return(0,n.jsx)(B,{margin:e.linkCardMargin,url:t,source:e.source})}},X=[h,F,T,M,_,q,Y],$=[h,F,W,M,G,O,Y];function J(e){var t=e.url,r=(0,i.Z)(e,["url"]),u=((0,o.Z)(a.fI).isDtto?$:X).reduce((function(e,n){return e||n.format(r,t)}),null);return(0,n.jsx)(n.Fragment,{children:u})}},9651:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(52322),i=r(2784),o=r(23871),a=(r(57777),r(31532)),u=r(12751);var c=function(e){var t=e.id,r=e.maxRatio,c=void 0===r?1:r,s=e.limitHeight,l=(0,u.y)(t),d=(0,i.useMemo)((function(){return l?Math.max(l.width/l.height,c):0}),[l,c]);return l?(0,n.jsx)(a.Z,{ratio:d,limitHeight:s,children:function(e){return(0,n.jsx)(o.Z,{image:l,loading:e?void 0:"lazy"})}}):null}},77557:function(e,t,r){"use strict";function n(e){return e.protocol="https:",e}function i(e,t){var r=e.split("/");return r[Math.min(t,r.length)]||""}r.d(t,{c:function(){return n},N:function(){return i}})},31532:function(e,t,r){"use strict";r.d(t,{Z:function(){return h}});var n=r(52322),i=r(34149),o=r(59394),a=r(54530),u=r(39658),c=r(68233),s=i.ZP.div.withConfig({componentId:"p5yeoo-0"})(["display:flex;align-items:center;justify-content:center;height:100%;width:100%;position:relative;",";img,video{display:block;margin:auto;cursor:zoom-out;}"],(function(e){return u.HY[e.transition]}));function l(e){var t=e.children,r=e.transition,i=void 0===r?u.uT.Popup:r,l=e.onClose,d=(0,a.Z)(e,["children","transition","onClose"]);return(0,n.jsx)(c.aV,(0,o.Z)((0,o.Z)({},d),{},{onClose:l,children:(0,n.jsx)(s,{transition:i,onClick:l,children:t})}))}var d=r(90809),m=r(2784),f=i.ZP.div.withConfig({componentId:"sc-2xcoxb-0"})(["--height:",";--max-height:",";display:",";justify-content:",";width:auto;height:var(--height);max-width:100%;max-height:var(--max-height);cursor:zoom-in;img,picture,video{width:auto;height:var(--height);max-width:100%;max-height:var(--max-height);}"],(function(e){return e.limitHeight?"auto":"100%"}),(function(e){return e.limitHeight?"".concat(e.maxVh||e.theme.MAX_POST_MEDIA_VH,"vh"):"none"}),(function(e){return e.limitHeight?"inline-block":"flex"}),(function(e){return!e.limitHeight&&"center"}));var h=function(e){var t=e.children,r=e.limitHeight,i=void 0===r||r,o=e.ratio,a=void 0===o?1:o,u=(0,m.useState)(!1),c=u[0],s=u[1],h=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f,{limitHeight:i,onClick:function(){return s(!0)},children:"function"===typeof t?t(!1):t}),(0,n.jsx)(l,{isOpen:c,onClose:function(){return s(!1)},children:(0,n.jsx)(f,{limitHeight:!0,maxVh:100,children:"function"===typeof t?t(c):t})})]});return i?h:(0,n.jsx)(d.Z,{ratio:a,children:h})}},38349:function(e,t,r){"use strict";r.d(t,{Z:function(){return d}});var n=r(52322),i=r(85354),o=r(2784),a=r(66811),u=r(49814),c=r(69383);var s=r(95275);var l=r(31532);var d=function(e){var t=e.className,r=e.src,d=e.fullSizeSrc,m=e.limitHeight,f=e.maxRatio,h=void 0===f?1:f,p=function(e){var t=(0,s.u)(e),r=(0,u.Z)((function(e){return function(e,t){return e.image.data[t]||{width:0,height:0}}(e,t)}),(function(e,t){return e.width===t.width&&e.height===t.height})),n=(0,o.useState)(null),i=n[0],l=n[1],d=(0,a.I0)(),m=(0,o.useCallback)((function(){i&&i.complete&&d(c.c.actions.setImageSize(t,{width:i.naturalWidth,height:i.naturalHeight}))}),[t,i,d]);return(0,o.useEffect)((function(){if(i&&!r.width&&!r.height)return i.complete?m():i.onload=m,function(){i.onload=null}}),[i,r,m]),[r,l]}(r),v=(0,i.Z)(p,2),w=v[0],g=v[1],x=w.width,b=w.height,k=(0,o.useMemo)((function(){return x&&b?Math.max(x/b,h):0}),[b,h,x]);return(0,n.jsx)(l.Z,{ratio:k,limitHeight:m,children:function(e){return(0,n.jsx)("img",{ref:g,className:t,alt:"",src:e&&d||r,width:x,height:b,referrerPolicy:"no-referrer",loading:e?void 0:"lazy"})}})}}}]);
//# sourceMappingURL=6118-f82209f85366d686ce2b.js.map